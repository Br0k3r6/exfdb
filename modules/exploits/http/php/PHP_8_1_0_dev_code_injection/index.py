#!/usr/bin/env python3

import os

def run():
	url = None
	while True:
		cmd_prompt = str(input("Exfdb (exploits/http/php/PHP-8.1.0-dev_code_injection)>"))
		cmd = cmd_prompt.lower()
		if cmd == "show options":
			print()
			print("-OPTIONS--------------------------")
			print("TARGET REQUIRED HELP")
			print("----------------------------------")
			print("RHOST  True     | Specify the target url (with http)")
			print("----------------------------------")
			print("Type exploit or run to run the exploit!")
			print("-OPTIONS--------------------------")
			print()
		elif cmd == "run" or cmd == "exploit":
			if url == None:
				print("[-] Url is not specified!")
			else:
				if "http://" in url or "https://" in url:
					os.system("python3 modules/exploits/http/php/PHP_8_1_0_dev_code_injection/exploit.py "+url)
				else:
					print("[-] Invalid url specified! Try to specify with http/s!")
		elif "set rhost " in cmd:
			try:
				url = cmd.split("set rhost ")[0]
				if url == "" or url == " ":
					url = cmd.split("set rhost ")[1]
			except:
				if url[1] == "" or url == " ":
					url = cmd.split("set rhost ")[1]
				else:
					print("[-] There is an Error in exploit: http/php/PHP-8.1.0-dev_code_injection !")
					print("[-] Please contact the creator or report the problem! (cant execute)")
					break
			print("[+] RHOST => "+str(url))
		elif cmd == "back":
			break
		elif cmd == "clear":
			os.system("clear")
		elif cmd == "exit" or cmd == "exit()" or cmd == "quit" or cmd == "quit()":
			exit()
		elif cmd == "help":
			print("-HELP--------------------------")
			print("back                 | Return back to main menu")
			print("set <option> <value> | The option will set to the value")
			print("exploit              | Run the exploit")
			print("run                  | Run the exploit")
			print("show options         | Display the options")
			print("clear                | Clear the Framework console")
			print("banner               | Display a random exfdb banner")
			print("exit                 | Exit the framework")
			print("quit                 | Exit the framework")
			print("-HELP--------------------------")
		else:
			print("[-] Unknown command: \"" + cmd + "\" in module!")
run()
