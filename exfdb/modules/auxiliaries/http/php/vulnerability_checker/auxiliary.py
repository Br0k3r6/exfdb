#!/usr/bin/env python3

import requests
import sys

url = sys.argv[1]

def main():
	try:
		response = requests.get(url, allow_redirects=False)
	except requests.ConnectionError:
		print("[-] There was an ConnectionError!")
		return
	headers = response.headers
	try:
		powered = headers['X-Powered-By'].lower()
		if powered == "php/8.1.0-dev":
			print("[+] Target is vulnerable for PHP/8.1.0-dev header injection!")
			print("[+] Module: modules/exploits/http/php/php_8.1.0_dev_code_injection")
			return
	except:
		print("[!] The X-Powered-By header is not defined!")
		print("[!] The X-Powered-By header is required for PHP scanning!")
		return

if __name__ == "__main__":
	main()
	del url
